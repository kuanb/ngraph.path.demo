webpackJsonp([1],{"0csq":function(t,e,n){"use strict";var i=n("JSwV"),r=n("lH2t"),s=n("S4H+"),a=n("pNOi"),o=n("LnN7"),u=n("F5sT"),d=n("3zJd"),l=n("14gb"),h=d({graph:"amsterdam-roads"});h.onChange(function(t){t.fromId===b.pointId&&t.toId===y.pointId||(N(),k())});var c=void 0,f=void 0,p=void 0,v=void 0,g=void 0,m=void 0,b=new o(k,L),y=new o(k,L),_={visible:!1,lastSearchTook:0,pathLength:0,graphNodeCount:"",graphLinksCount:""},w=u(h),x={loadPositions:I,updateSearchAlgorithm:function(){M(),h.set("finder",w.pathFinderSettings.selected),k()},updateSelectedGraph:function(){h.set({graph:w.graphSettings.selected,fromId:-1,toId:-1}),I(),S()},getGraph:function(){return c},getGraphBBox:function(){return p},progress:new a,stats:_,routeStart:b,routeEnd:y,pathInfo:{svgPath:"",svgPaths:[],noPath:!1},handleSceneClick:function(t){b.visible?y.visible?S():E(y,t):E(b,t)},clearRoute:S,pathFinderSettings:w.pathFinderSettings,graphSettings:w.graphSettings};function k(){if(b.visible&&y.visible){var t,e=function(t,e){return g.find(t,e).map(function(t){return t.data})}(b.pointId,y.pointId);if(x.pathInfo.noPath=0===e.length,x.pathInfo.svgPath=(t=e).length<1?"":t.map(function(t,e){var n;return(0===e?"M":"")+(n=t).x+","+n.y}).join(" "),e.length>0){var n={width:Math.round(100*Math.random()),path:x.pathInfo.svgPath,color:function(){for(var t="#",e=0;e<6;e++)t+=(16*Math.random()|0).toString(16);return t}(),opacity:Math.round(5*Math.random())/10+.3};x.pathInfo.svgPaths.push(n)}}else x.pathInfo.svgPath=""}function S(){b.clear(),y.clear(),h.set({fromId:-1,toId:-1})}function E(t,e){if(v&&f){var n=L(f[Math.floor(Math.random()*f.length)],f[Math.floor(Math.random()*f.length)]);if(!n)throw new Error("Point should be defined at this moment");t.setFrom(n),e&&t.triggerReDraw()}}function I(){var t=h.get("graph");v=null,c=null,f=null,_.visible=!1,x.progress.reset(),s(t,x.progress).then(C).catch(function(t){x.progress.setError("Could not load the graph",t)})}function C(t){c=t.graph,p=t.graphBBox,g=null,function(t){(v=i()).initAsync(t,{progress:function(t,e){t%500==0&&(x.progress.completed=Math.round(100*t/e)+"%")},done:function(){x.progress.treeReady=!0}})}(f=t.points),m={"a-greedy-star":r.aGreedy(c,{distance:R,heuristic:R}),nba:r.nba(c,{distance:R,heuristic:R}),"astar-uni":r.aStar(c,{distance:R,heuristic:R}),dijkstra:r.aStar(c,{distance:R})},M(),N(),_.graphNodeCount=P(c.getNodesCount()),_.graphLinksCount=P(c.getLinksCount()),l.fire("graph-loaded"),setTimeout(function(){k()},0)}function M(){var t=w.pathFinderSettings.selected;if(!(g=m[t]))throw new Error("Cannot find pathfinder "+t)}function N(){if(c){var t=h.get("fromId"),e=h.get("toId"),n=c.getNode(t),i=c.getNode(e);n&&b.setFrom(n),i&&y.setFrom(i)}}function P(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function L(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;if(v){var i=v.pointsAround(t,e,n).map(function(t){return c.getNode(t/2)}).sort(function(n,i){return T(n.data,t,e)-T(i.data,t,e)});return i.length>0?i[0]:L(t,e,2*n)}}function T(t,e,n){var i=t.x-e,r=t.y-n;return Math.sqrt(i*i+r*r)}function R(t,e){return Y(t.data,e.data)}function Y(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}t.exports=x},"14gb":function(t,e,n){"use strict";var i=n("puH/")({});t.exports=i},"3Zuw":function(t,e,n){"use strict";var i=s(n("Zrlr")),r=s(n("wxAW"));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(){(0,i.default)(this,t),this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}return(0,r.default)(t,[{key:"growBy",value:function(t){this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t}},{key:"addPoint",value:function(t,e){if(void 0===t)throw new Error("Point is not defined");var n=t,i=e;void 0===i&&(n=t.x,i=t.y),n<this.minX&&(this.minX=n),n>this.maxX&&(this.maxX=n),i<this.minY&&(this.minY=i),i>this.maxY&&(this.maxY=i)}},{key:"addRect",value:function(t){if(!t)throw new Error("rect is not defined");this.addPoint(t.left,t.top),this.addPoint(t.right,t.top),this.addPoint(t.left,t.bottom),this.addPoint(t.right,t.bottom)}},{key:"merge",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.minY<this.minY&&(this.minY=t.minY),t.maxX>this.maxX&&(this.maxX=t.maxX),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"left",get:function(){return this.minX}},{key:"top",get:function(){return this.minY}},{key:"right",get:function(){return this.maxX}},{key:"bottom",get:function(){return this.maxY}},{key:"width",get:function(){return this.maxX-this.minX}},{key:"height",get:function(){return this.maxY-this.minY}},{key:"cx",get:function(){return(this.minX+this.maxX)/2}},{key:"cy",get:function(){return(this.minY+this.maxY)/2}}]),t}();t.exports=a},"4kcz":function(t,e){},"81Uq":function(t,e){},"DzQ/":function(t,e,n){"use strict";var i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("canvas",{ref:"canvas",staticClass:"absolute"}),t._v(" "),t.webGLEnabled?t._e():n("div",[t._m(0)]),t._v(" "),t.webGLEnabled?n("div",[n("svg",{ref:"svg",staticClass:"svg-overlay absolute"},[n("g",{staticClass:"scene"},[t._l(t.pathInfo.svgPaths,function(t){return n("path",{attrs:{d:t.path,"stroke-width":t.width,stroke:t.color,"stroke-opacity":"0.1","fill-opacity":"0",fill:"transparent"}})}),t._v(" "),n("path",{ref:"foundPath",attrs:{d:t.pathInfo.svgPath,"stroke-width":"1x",stroke:"#6699cc","fill-opacity":"0.05",fill:"transparent"}}),t._v(" "),t.routeStart.visible?n("route-point",{attrs:{point:t.routeStart,scale:t.scale,r:t.routeStart.r}}):t._e(),t._v(" "),t.routeEnd.visible?n("route-point",{attrs:{point:t.routeEnd,scale:t.scale,r:t.routeEnd.r}}):t._e()],2)])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"absolute no-webgl"},[e("h4",[this._v("WebGL is not enabled :(")]),this._v(" "),e("div",[this._v("While "),e("a",{staticClass:"highlighted",attrs:{href:"https://github.com/anvaka/ngraph.path"}},[this._v("ngraph.path")]),this._v(" does not require any webgl, this demo needs it.")]),this._v(" "),e("iframe",{staticClass:"video-demo",attrs:{src:"https://www.youtube.com/embed/hGeZuIEV6KU",frameborder:"0",allowfullscreen:""}})])}]};e.a=i},F5sT:function(t,e,n){"use strict";t.exports=function(t){var e=function(t){return{selected:t.get("graph"),graphs:[{value:"amsterdam-roads",name:"Amsterdam (76K edges, 1.1 MB)"},{value:"seattle-roads",name:"Seattle (173K edges, 2.4 MB)"},{value:"rome-roads",name:"Rome (258K edges, 3.8 MB)"},{value:"delhi-roads",name:"Delhi (280K edges, 3.9 MB)"},{value:"moscow-roads",name:"Moscow (451K edges, 6.5 MB)"},{value:"USA-road-d.NY",name:"New York (730K edges, 7.6 MB)"}]}}(t),n=function(t){return{selected:t.get("finder")||"nba",algorithms:[{value:"a-greedy-star",name:"Greedy A* (suboptimal)"},{value:"nba",name:"NBA*"},{value:"astar-uni",name:"Unidirectional A*"},{value:"dijkstra",name:"Dijkstra"}]}}(t);return{graphSettings:e,pathFinderSettings:n}}},LnN7:function(t,e,n){"use strict";var i=s(n("Zrlr")),r=s(n("wxAW"));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e,n){(0,i.default)(this,t),this.visible=!1,this.beingDragged=!1,this.pointId=-1,this.x=0,this.y=0,this.r=18,this.pointChanged=e,this.findNearestPoint=n}return(0,r.default)(t,[{key:"setFrom",value:function(t){this.visible=!0,this.pointId=t.id,this.x=t.data.x,this.y=t.data.y,this.pointChanged(this)}},{key:"triggerReDraw",value:function(){}},{key:"clear",value:function(){this.visible=!1,this.pointId=-1,this.x=0,this.y=0,this.pointChanged(this)}}]),t}();t.exports=a},LwKS:function(t,e,n){"use strict";var i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"about"},[n("div",{staticClass:"background absolute",on:{click:function(e){return e.preventDefault(),t.close(e)}}}),t._v(" "),n("div",{staticClass:"content"},[n("h3",[t._v("ngraph.path "),n("a",{staticClass:"close bold",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.close(e)}}},[t._v("close")])]),t._v(" "),t._m(0),n("p",[t._v("\n      Don't use this website for actual navigation :).\n    ")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),n("a",{staticClass:"large-close bold",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.close(e)}}},[t._v("\n      close\n    ")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n      This website is a demo for the "),e("a",{staticClass:"highlighted",attrs:{href:"https://github.com/anvaka/ngraph.path"}},[this._v("ngraph.path")]),this._v("\n      library. The library implements pathfinding algorithms for generic graphs (not limited to grids).\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("My goal was to build a very fast library, that could help many developers\n      find their paths. In my tests, the library showed great performance with median\n      path finding speed "),e("span",{staticClass:"bold"},[this._v("34ms")]),this._v(" on "),e("span",{staticClass:"bold"},[this._v("733,844")]),this._v(" edges graph.\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("I built the roads graph for this demo using amazing "),e("a",{staticClass:"highlighted",attrs:{href:"http://www.openstreetmap.org/",target:"_blank"}},[this._v("OpenStreetMap")]),this._v(".\n    ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{staticClass:"highlighted",attrs:{href:"https://github.com/anvaka/ngraph.path"}},[this._v("Learn more ")]),this._v(" about this project on GitHub\n      ")]),e("li",[this._v("\n      Stay tuned for updates on "),e("a",{staticClass:"highlighted",attrs:{href:"https://twitter.com/anvaka"}},[this._v("Twitter.")])]),e("li",[e("a",{staticClass:"highlighted",attrs:{href:"https://www.youtube.com/watch?v=hGeZuIEV6KU"}},[this._v(" Watch a video")]),this._v(" demo.\n      ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("With passion,"),e("br"),this._v(" Anvaka")])}]};e.a=i},M93x:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("xJD8"),r=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);var a=n("DzQ/");var o=function(t){n("81Uq")},u=n("VU/8")(r.a,a.a,!1,o,null,null);e.default=u.exports},NHnr:function(t,e,n){"use strict";var i=s(n("7+uW")),r=s(n("M93x"));function s(t){return t&&t.__esModule?t:{default:t}}i.default.config.productionTip=!1,new i.default({el:"#app",template:"<App/>",components:{App:r.default}})},"S4H+":function(t,e,n){"use strict";var i,r=n("//Fk"),s=(i=r)&&i.__esModule?i:{default:i};var a=n("vccH"),o="static/",u=n("T/ob"),d=n("3Zuw"),l=n("4gmu");t.exports=function(t,e){var n=u(),i=void 0,r=void 0,h=new d;return a(o+"/"+t+".co.bin",{responseType:"arraybuffer",progress:v("Loading intersection coordinates")}).then(function(t){return i=new Int32Array(t),console.log("Downloaded nodes: "+i.length/2),function(t){return console.time("add nodes to graph"),new s.default(function(n){l(t,c,function(){e.pointsReady=!0,console.timeEnd("add nodes to graph"),n()},{step:2}),e.pointsReady=!0})}(i)}).then(function(){return a(o+"/"+t+".gr.bin",{responseType:"arraybuffer",progress:v("Loading roads graph")}).then(f)}).then(function(){return{graph:n,points:i,links:r,graphBBox:h}});function c(t,i,r){var s=Math.floor(i/2),a=r[i+1];n.addNode(s,{x:t,y:a}),h.addPoint(t,a),i%500==0&&(e.completed=Math.round(100*i/r.length)+"%")}function f(t){return r=new Int32Array(t),console.time("add edges to graph"),new s.default(function(t){l(r,p,function(){console.timeEnd("add edges to graph"),e.linksReady=!0,console.log(n.getLinksCount()+" edges; "+n.getNodesCount()+" nodes."),t()},{step:2})})}function p(t,i,r){var s=t-1,a=r[i+1]-1;n.addLink(s,a),i%500==0&&(e.completed=Math.round(100*i/r.length)+"%")}function v(t){return function(t){e.completed=Math.round(100*t.percent)+"%"}}}},SRj4:function(t,e,n){"use strict";var i=u(n("Zx67")),r=u(n("Zrlr")),s=u(n("wxAW")),a=u(n("zwoO")),o=u(n("Pf15"));function u(t){return t&&t.__esModule?t:{default:t}}var d=function(t){function e(t,n){(0,r.default)(this,e);var s=(0,a.default)(this,(e.__proto__||(0,i.default)(e)).call(this));return s.g=t,s.dx=0,s.dy=0,s.scale=0,s.drawCallback=n||l,s}return(0,o.default)(e,t),(0,s.default)(e,[{key:"draw",value:function(){var t=this.worldTransform;if(e=this.worldTransform,n=this,e.scale!=n.scale||e.dx!==n.dx||e.dy!==n.dy){var e,n,i=this.scene.getPixelRatio(),r=t.scale/i,s=t.dx/i,a=t.dy/i;this.g.setAttributeNS(null,"transform","matrix("+r+", 0, 0, "+r+", "+s+", "+a+")"),this.scale=t.scale,this.dx=t.dx,this.dy=t.dy,this.drawCallback(this)}}}]),e}(n("vkLu").Element);function l(){}t.exports=d},Zs8U:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={mounted:function(){var t=this;this.closeHandler=function(e){27===e.keyCode&&(e.preventDefault(),t.close())},document.addEventListener("keyup",this.closeHandler)},beforeDestroy:function(){document.removeEventListener("keyup",this.closeHandler)},methods:{close:function(){this.$emit("close")}}}},c27y:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Zs8U"),r=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);var a=n("LwKS");var o=function(t){n("4kcz")},u=n("VU/8")(r.a,a.a,!1,o,null,null);e.default=u.exports},nEty:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"RoutePoint",props:{point:Object,scale:Number,symbol:String,r:Number,strokeWidth:{type:Number,default:2},fontSize:{type:Number,default:28},textY:{type:Number,default:10}},computed:{screenScale:function(){var t=1/this.scale;return"matrix("+t+", 0, 0, "+t+", "+this.point.x+", "+this.point.y+")"}}}},pNOi:function(t,e,n){"use strict";var i=s(n("Zrlr")),r=s(n("wxAW"));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(){(0,i.default)(this,t),this.reset()}return(0,r.default)(t,[{key:"setError",value:function(t,e){this.errorMessage=t,this.errorDetails=e}},{key:"reset",value:function(){this.errorMessage=null,this.errorDetails=null,this.message="",this.completed="",this.pointsReady=!1,this.linksReady=!1,this.treeReady=!1}},{key:"visible",get:function(){return!(this.pointsReady&&this.linksReady&&this.treeReady)}}]),t}();t.exports=a},qEFR:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("nEty"),r=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);var a=n("us5R"),o=n("VU/8")(r.a,a.a,!1,null,null,null);e.default=o.exports},us5R:function(t,e,n){"use strict";var i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{attrs:{transform:t.screenScale}},[n("circle",{attrs:{r:t.r,fill:"#6699CC","fill-opacity":"0.3",stroke:"white","stroke-width":t.strokeWidth}}),t._v(" "),n("text",{staticClass:"no-pointer",attrs:{"font-size":t.fontSize,fill:"white","text-anchor":"middle",y:t.textY}},[t._v(t._s(t.symbol))])])},staticRenderFns:[]};e.a=i},vccH:function(t,e,n){"use strict";var i,r=n("//Fk"),s=(i=r)&&i.__esModule?i:{default:i};t.exports=function(t,e){e||(e={});return new s.default(function(n,i){var r=new XMLHttpRequest;"function"==typeof e.progress&&r.addEventListener("progress",function(t){t.lengthComputable&&e.progress({loaded:t.loaded,total:t.total,percent:t.loaded/t.total})},!1);r.addEventListener("load",function(){if(200===r.status){var s=r.response;"json"===e.responseType&&"string"==typeof s&&(s=JSON.parse(s)),n(s)}else i("Unexpected status code "+r.status+" when calling "+t)},!1),r.addEventListener("error",function(){i("Failed to download "+t)},!1),r.addEventListener("abort",function(){i("Cancelled download of "+t)},!1),r.open("GET",t),e.responseType&&(r.responseType=e.responseType);r.send(null)})}},xJD8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(n("0csq")),r=o(n("SRj4")),s=o(n("qEFR")),a=o(n("c27y"));function o(t){return t&&t.__esModule?t:{default:t}}var u=n("14gb"),d=n("vkLu");e.default={name:"app",components:{RoutePoint:s.default,About:a.default},mounted:function(){this.webGLEnabled=d.isWebGLEnabled(this.$refs.canvas),this.webGLEnabled&&(i.default.loadPositions(),u.on("graph-loaded",this.createScene,this))},beforeDestroy:function(){u.off("graph-loaded",this.createScene),this.ensurePreviousSceneDestroyed()},data:function(){return{webGLEnabled:!0,loaded:!1,detailsVisible:!1,progress:i.default.progress,routeStart:i.default.routeStart,routeEnd:i.default.routeEnd,stats:i.default.stats,scale:1,pathInfo:i.default.pathInfo,pathFinder:i.default.pathFinderSettings,graphSettings:i.default.graphSettings,aboutVisible:!1}},computed:{graphNameTitle:function(){var t=this.stats;return t?t.graphNodeCount+" nodes; "+t.graphLinksCount+" edges":""},helpVisible:function(){return!(this.routeStart.visible&&this.routeEnd.visible)},pathText:function(){return this.pathInfo.noPath?"No path ("+this.stats.lastSearchTook+")":"Found in: "+this.stats.lastSearchTook}},methods:{clearRoute:function(){i.default.clearRoute()},getHelpText:function(){return this.routeStart.visible?this.routeEnd.visible?void 0:"Click anywhere to select destination":"Click anywhere to select starting point"},ensurePreviousSceneDestroyed:function(){this.scene&&(this.scene.dispose(),this.scene=null),this.unsubscribeMoveEvents&&(this.unsubscribeMoveEvents(),this.unsubscribeMoveEvents=null)},createScene:function(){var t=this;this.ensurePreviousSceneDestroyed();var e=this.$refs.canvas;this.loaded=!0,this.scene=d.scene(e);var n=this.scene,s=new r.default(this.$refs.svg.querySelector(".scene"),this.updateSVGElements.bind(this));this.scene.appendChild(s),n.setClearColor(1,1,1,1);var a=i.default.getGraphBBox().width/8;n.setViewBox({left:-a,top:-a,right:a,bottom:a});var o=i.default.getGraph(),u=o.getLinksCount(),l=new d.WireCollection(u);l.color={r:0,g:0,b:0,a:.1},o.forEachLink(function(t){var e=o.getNode(t.fromId).data,n=o.getNode(t.toId).data;l.add({from:e,to:n})}),n.appendChild(l);var h=0,c=setInterval(function(){if(t.onSceneClick(h%100==0),(h+=1)>500){clearInterval(c),console.log("drawing pt 1 done");var e=setInterval(function(){t.onSceneClick(!0),(h+=1)>1e3&&(clearInterval(e),console.log("done drawing"))},150)}},60)},updateSVGElements:function(t){var e=6/t.scale;Array.isArray(this.$refs.foundPath)?this.$refs.foundPath.map(function(t){return t.setAttributeNS(null,"stroke-width",e+"px")}):this.$refs.foundPath.setAttributeNS(null,"stroke-width",e+"px"),this.scale=t.scale/this.scene.getPixelRatio()*5},updateGraph:function(){this.ensurePreviousSceneDestroyed(),setTimeout(function(){i.default.updateSelectedGraph()},2)},updateSearchAlgorithm:function(){i.default.updateSearchAlgorithm()},onSceneClick:function(t){i.default.handleSceneClick(t)}}}}},["NHnr"]);
//# sourceMappingURL=app.774eed7dbb45d43483b7.js.map